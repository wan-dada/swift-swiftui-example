## SwiftUI 如何处理视图

> 本文来源：https://www.fatbobman.com/

SwiftUI 从加载视图、响应状态到屏幕绘制大概经历如下过程：

- 从根视图开始按视图层级结构沿特定分支（依据初始状态）逐个实例化视图，直到满足当前全部的显示所需
- 上述实例化后的视图值（结构值，非 body 值）将被保存在 SwiftUI 的托管数据池中
- 根据视图的依赖信息在 AttributeGraph 数据池中创建与当前显示的视图树对应的依赖图，并监控依赖的变化
- 依据 SwiftUI 数据池中视图值的 body 属性或视图类型的特定类型方法（非公开）进行布局和渲染
- 当用户或系统的某些行为导致依赖数据发生变化后，SwiftUI 将根据依赖图定位到需要重新评估的视图
- 以需重新评估的视图为根，按视图层级结构依当前状态逐个实例化视图类型（到满足全部显示所需为止）
- 将已不再需要参与布局和渲染的视图的值从 SwiftUI 数据池中移除，并在数据池中添加上新增的视图值
- 对于仍需显示但视图值发生变化的视图，使用新的视图值替换原有视图值
- 重组依赖图并绘制新增及发生变化的视图
- 周而复始、循环往复
