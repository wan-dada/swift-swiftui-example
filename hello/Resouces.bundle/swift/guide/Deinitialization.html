<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name="viewport" content=" width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no"> 
    <link rel="stylesheet" href="../../markdown.css" />
    <title>Deinitialization</title>
</head>
<body class='typora-export'><div class='typora-export-content'>
<div id='write'><p><em><span>析构器</span></em><span>只适用于类类型，当一个类的实例被释放之前，析构器会被立即调用。析构器用关键字 </span><code>deinit</code><span> 来标示，类似于构造器要用 </span><code>init</code><span> 来标示。</span></p><h2 id='析构过程原理'><span>析构过程原理 </span></h2><p><span>Swift 会自动释放不再需要的实例以释放资源。如 </span><a href='./24_Automatic_Reference_Counting.md'><span>自动引用计数</span></a><span> 章节中所讲述，Swift 通过</span><em><span>自动引用计数（ARC)</span></em><span> 处理实例的内存管理。通常当你的实例被释放时不需要手动地去清理。但是，当使用自己的资源时，你可能需要进行一些额外的清理。例如，如果创建了一个自定义的类来打开一个文件，并写入一些数据，你可能需要在类实例被释放之前手动去关闭该文件。</span></p><p><span>在类的定义中，每个类最多只能有一个析构器，而且析构器不带任何参数和圆括号，如下所示：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="swift"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="swift"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation"><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">deinit</span> <span class="cm-punctuation">{</span></span></pre></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-comment">// 执行析构过程</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-punctuation">}</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 66px;"></div><div class="CodeMirror-gutters" style="display: none; height: 66px;"></div></div></div></pre><p><span>析构器是在实例释放发生前被自动调用的。你不能主动调用析构器。子类继承了父类的析构器，并且在子类析构器实现的最后，父类的析构器会被自动调用。即使子类没有提供自己的析构器，父类的析构器也同样会被调用。</span></p><p><span>因为直到实例的析构器被调用后，实例才会被释放，所以析构器可以访问实例的所有属性，并且可以根据那些属性可以修改它的行为（比如查找一个需要被关闭的文件）。</span></p><h2 id='析构器实践'><span>析构器实践 </span></h2><p><span>这是一个析构器实践的例子。这个例子描述了一个简单的游戏，这里定义了两种新类型，分别是 </span><code>Bank</code><span> 和 </span><code>Player</code><span>。</span><code>Bank</code><span> 类管理一种虚拟硬币，确保流通的硬币数量永远不可能超过 10,000。在游戏中有且只能有一个 </span><code>Bank</code><span> 存在，因此 </span><code>Bank</code><span> 用类来实现，并使用类型属性和类型方法来存储和管理其当前状态。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="swift"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="swift"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">Bank</span> <span class="cm-punctuation">{</span></span></pre></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">static</span> <span class="cm-keyword">var</span> <span class="cm-def">coinsInBank</span> <span class="cm-operator">=</span> <span class="cm-number">10_000</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">static</span> <span class="cm-keyword">func</span> <span class="cm-def">distribute</span><span class="cm-punctuation">(</span><span class="cm-variable">coins</span> <span class="cm-variable">numberOfCoinsRequested</span><span class="cm-punctuation">:</span> <span class="cm-variable-2">Int</span><span class="cm-punctuation">)</span> <span class="cm-operator">-&gt;</span> <span class="cm-variable-2">Int</span> <span class="cm-punctuation">{</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">let</span> <span class="cm-def">numberOfCoinsToVend</span> <span class="cm-operator">=</span> <span class="cm-variable">min</span><span class="cm-punctuation">(</span><span class="cm-variable">numberOfCoinsRequested</span><span class="cm-punctuation">,</span> <span class="cm-variable">coinsInBank</span><span class="cm-punctuation">)</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">coinsInBank</span> <span class="cm-operator">-=</span> <span class="cm-variable">numberOfCoinsToVend</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-keyword">return</span> <span class="cm-variable">numberOfCoinsToVend</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-punctuation">}</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">static</span> <span class="cm-keyword">func</span> <span class="cm-def">receive</span><span class="cm-punctuation">(</span><span class="cm-variable">coins</span><span class="cm-punctuation">:</span> <span class="cm-variable-2">Int</span><span class="cm-punctuation">)</span> <span class="cm-punctuation">{</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">coinsInBank</span> <span class="cm-operator">+=</span> <span class="cm-variable">coins</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-punctuation">}</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-punctuation">}</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 286px;"></div><div class="CodeMirror-gutters" style="display: none; height: 286px;"></div></div></div></pre><p><code>Bank</code><span> 使用 </span><code>coinsInBank</code><span> 属性来跟踪它当前拥有的硬币数量。</span><code>Bank</code><span> 还提供了两个方法，</span><code>distribute(coins:)</code><span> 和 </span><code>receive(coins:)</code><span>，分别用来处理硬币的分发和收集。</span></p><p><code>distribute(coins:)</code><span> 方法在 </span><code>Bank</code><span> 对象分发硬币之前检查是否有足够的硬币。如果硬币不足，</span><code>Bank</code><span> 对象会返回一个比请求时小的数字（如果 </span><code>Bank</code><span> 对象中没有硬币了就返回 </span><code>0</code><span>）。此方法返回一个整型值，表示提供的硬币的实际数量。</span></p><p><code>receive(coins:)</code><span> 方法只是将 </span><code>Bank</code><span> 实例接收到的硬币数目加回硬币存储中。</span></p><p><code>Player</code><span> 类描述了游戏中的一个玩家。每一个玩家在任意时间都有一定数量的硬币存储在他们的钱包中。这通过玩家的 </span><code>coinsInPurse</code><span> 属性来表示：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="swift"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="swift"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">class</span> <span class="cm-def">Player</span> <span class="cm-punctuation">{</span></span></pre></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">var</span> <span class="cm-def">coinsInPurse</span><span class="cm-punctuation">:</span> <span class="cm-variable-2">Int</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">init</span><span class="cm-punctuation">(</span><span class="cm-variable">coins</span><span class="cm-punctuation">:</span> <span class="cm-variable-2">Int</span><span class="cm-punctuation">)</span> <span class="cm-punctuation">{</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">coinsInPurse</span> <span class="cm-operator">=</span> <span class="cm-variable">Bank</span><span class="cm-property">.distribute</span><span class="cm-punctuation">(</span><span class="cm-variable">coins</span><span class="cm-punctuation">:</span> <span class="cm-variable">coins</span><span class="cm-punctuation">)</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-punctuation">}</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">func</span> <span class="cm-def">win</span><span class="cm-punctuation">(</span><span class="cm-variable">coins</span><span class="cm-punctuation">:</span> <span class="cm-variable-2">Int</span><span class="cm-punctuation">)</span> <span class="cm-punctuation">{</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">coinsInPurse</span> <span class="cm-operator">+=</span> <span class="cm-variable">Bank</span><span class="cm-property">.distribute</span><span class="cm-punctuation">(</span><span class="cm-variable">coins</span><span class="cm-punctuation">:</span> <span class="cm-variable">coins</span><span class="cm-punctuation">)</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-punctuation">}</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-keyword">deinit</span> <span class="cm-punctuation">{</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp;<span class="cm-variable">Bank</span><span class="cm-property">.receive</span><span class="cm-punctuation">(</span><span class="cm-variable">coins</span><span class="cm-punctuation">:</span> <span class="cm-variable">coinsInPurse</span><span class="cm-punctuation">)</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"> &nbsp; &nbsp;<span class="cm-punctuation">}</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-punctuation">}</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 264px;"></div><div class="CodeMirror-gutters" style="display: none; height: 264px;"></div></div></div></pre><p><span>每个 </span><code>Player</code><span> 实例在初始化的过程中，都从 </span><code>Bank</code><span> 对象获取指定数量的硬币。如果没有足够的硬币可用，</span><code>Player</code><span> 实例可能会收到比指定数量少的硬币。</span></p><p><code>Player</code><span> 类定义了一个 </span><code>win(coins:)</code><span> 方法，该方法从 </span><code>Bank</code><span> 对象获取一定数量的硬币，并把它们添加到玩家的钱包。</span><code>Player</code><span> 类还实现了一个析构器，这个析构器在 </span><code>Player</code><span> 实例释放前被调用。在这里，析构器的作用只是将玩家的所有硬币都返还给 </span><code>Bank</code><span> 对象：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="swift"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="swift"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-keyword">var</span> <span class="cm-def">playerOne</span><span class="cm-punctuation">:</span> <span class="cm-variable">Player</span><span class="cm-operator">?</span> <span class="cm-operator">=</span> <span class="cm-variable">Player</span><span class="cm-punctuation">(</span><span class="cm-variable">coins</span><span class="cm-punctuation">:</span> <span class="cm-number">100</span><span class="cm-punctuation">)</span></span></pre></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">print</span><span class="cm-punctuation">(</span><span class="cm-string">"A new player has joined the game with \(</span><span class="cm-variable">playerOne</span><span class="cm-operator">!</span><span class="cm-property">.coinsInPurse</span><span class="cm-string">) coins"</span><span class="cm-punctuation">)</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// 打印“A new player has joined the game with 100 coins”</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">print</span><span class="cm-punctuation">(</span><span class="cm-string">"There are now \(</span><span class="cm-variable">Bank</span><span class="cm-property">.coinsInBank</span><span class="cm-string">) coins left in the bank"</span><span class="cm-punctuation">)</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// 打印“There are now 9900 coins left in the bank”</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 154px;"></div><div class="CodeMirror-gutters" style="display: none; height: 154px;"></div></div></div></pre><p><span>创建一个 </span><code>Player</code><span> 实例的时候，会向 </span><code>Bank</code><span> 对象申请得到 100 个硬币，前提是有足够的硬币可用。这个 </span><code>Player</code><span> 实例存储在一个名为 </span><code>playerOne</code><span> 的可选类型的变量中。这里使用了一个可选类型的变量，是因为玩家可以随时离开游戏，设置为可选使你可以追踪玩家当前是否在游戏中。</span></p><p><span>因为 </span><code>playerOne</code><span> 是可选的，所以在访问其 </span><code>coinsInPurse</code><span> 属性来打印钱包中的硬币数量和调用 </span><code>win(coins:)</code><span> 方法时，使用感叹号（</span><code>!</code><span>）强制解包：</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="swift"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="swift"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">playerOne</span><span class="cm-operator">!</span><span class="cm-property">.win</span><span class="cm-punctuation">(</span><span class="cm-variable">coins</span><span class="cm-punctuation">:</span> <span class="cm-number">2_000</span><span class="cm-punctuation">)</span></span></pre></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">print</span><span class="cm-punctuation">(</span><span class="cm-string">"PlayerOne won 2000 coins &amp; now has \(</span><span class="cm-variable">playerOne</span><span class="cm-operator">!</span><span class="cm-property">.coinsInPurse</span><span class="cm-string">) coins"</span><span class="cm-punctuation">)</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// 打印“PlayerOne won 2000 coins &amp; now has 2100 coins”</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">print</span><span class="cm-punctuation">(</span><span class="cm-string">"The bank now only has \(</span><span class="cm-variable">Bank</span><span class="cm-property">.coinsInBank</span><span class="cm-string">) coins left"</span><span class="cm-punctuation">)</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// 打印“The bank now only has 7900 coins left”</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 154px;"></div><div class="CodeMirror-gutters" style="display: none; height: 154px;"></div></div></div></pre><p><span>在这里，玩家已经赢得了 2,000 枚硬币，所以玩家的钱包中现在有 2,100 枚硬币，而 </span><code>Bank</code><span> 对象只剩余 7,900 枚硬币。</span></p><pre class="md-fences md-end-block ty-contain-cm modeLoaded" spellcheck="false" lang="swift"><div class="CodeMirror cm-s-inner cm-s-null-scroll CodeMirror-wrap" lang="swift"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 9px; left: 8px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; bottom: -1em; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 0px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines" role="presentation"><div role="presentation" style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-code" role="presentation" style=""><div class="CodeMirror-activeline" style="position: relative;"><div class="CodeMirror-activeline-background CodeMirror-linebackground"></div><div class="CodeMirror-gutter-background CodeMirror-activeline-gutter" style="left: 0px; width: 0px;"></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">playerOne</span> <span class="cm-operator">=</span> <span class="cm-atom">nil</span></span></pre></div><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">print</span><span class="cm-punctuation">(</span><span class="cm-string">"PlayerOne has left the game"</span><span class="cm-punctuation">)</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// 打印“PlayerOne has left the game”</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-variable">print</span><span class="cm-punctuation">(</span><span class="cm-string">"The bank now has \(</span><span class="cm-variable">Bank</span><span class="cm-property">.coinsInBank</span><span class="cm-string">) coins"</span><span class="cm-punctuation">)</span></span></pre><pre class="CodeMirror-line" role="presentation"><span role="presentation" style="padding-right: 0.1px;"><span class="cm-comment">// 打印“The bank now has 10000 coins”</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 0px; width: 1px; border-bottom-width: 0px; border-bottom-style: solid; border-bottom-color: transparent; top: 110px;"></div><div class="CodeMirror-gutters" style="display: none; height: 110px;"></div></div></div></pre><p><span>玩家现在已经离开了游戏。这通过将可选类型的 </span><code>playerOne</code><span> 变量设置为 </span><code>nil</code><span> 来表示，意味着“没有 </span><code>Player</code><span> 实例”。当这一切发生时，</span><code>playerOne</code><span> 变量对 </span><code>Player</code><span> 实例的引用被破坏了。没有其它属性或者变量引用 </span><code>Player</code><span> 实例，因此该实例会被释放，以便回收内存。在这之前，该实例的析构器被自动调用，玩家的硬币被返还给银行。</span></p></div></div>
</body>
</html>
